import{P as V,i as d,x as K,f as P,y as B,d as e,o as t,a as o,h as r,k as E,b as v,a1 as L,j as y,F as q,l as H,t as M,n as h,W as _}from"./app-DK7Qb6e3.js";import{_ as N}from"./InputError-D4mNXB1g.js";import{_ as D}from"./InputLabel-DpO1hxLV.js";import{_ as Q}from"./TextInput-Bp0CZvuX.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"py-12"},$={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},O={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},j={class:"p-6 bg-white border-b border-gray-200"},z={class:"max-w-3xl"},G={key:0,class:"text-lg font-medium text-gray-900"},I={key:1,class:"text-lg font-medium text-gray-900"},U={key:2,class:"text-lg font-medium text-gray-900"},J={key:3},X={key:0},Z={class:"mt-4 max-w-xl text-sm text-gray-600"},ee={key:0,class:"font-semibold"},te={key:1},oe=["innerHTML"],se={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},ne={class:"font-semibold"},ae=["innerHTML"],re={key:1,class:"mt-4 max-w-md"},ie={key:1},le={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},ce={class:"mt-8 flex flex-wrap items-center gap-3"},ue={key:0},de=["disabled"],fe={key:0},me={key:1},ge={key:1,class:"flex flex-wrap items-center gap-3"},pe=["disabled"],be=["disabled"],ve={key:0},ye={key:1},he={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(k){const C=k,F=V(),a=d(!1),s=d(!1),l=d(!1),m=d(null),g=d(null),f=d([]),c=K({code:""}),u=P(()=>{var i;return!a.value&&((i=F.props.auth.user)==null?void 0:i.two_factor_enabled)});B(u,()=>{u.value||(c.reset(),c.clearErrors())});const T=()=>{confirm("Please confirm your password to enable 2FA.")&&(a.value=!0,_.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([S(),A(),b()]),onFinish:()=>{a.value=!1,s.value=C.requiresConfirmation}}))},S=()=>axios.get(route("two-factor.qr-code")).then(i=>{m.value=i.data.svg}),A=()=>axios.get(route("two-factor.secret-key")).then(i=>{g.value=i.data.secretKey}),b=()=>axios.get(route("two-factor.recovery-codes")).then(i=>{f.value=i.data}),x=()=>{c.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.value=!1,m.value=null,g.value=null}})},R=()=>{confirm("Please confirm your password to regenerate recovery codes.")&&axios.post(route("two-factor.recovery-codes")).then(()=>b())},w=()=>{confirm("Please confirm your password to disable 2FA.")&&(l.value=!0,_.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{l.value=!1,s.value=!1}}))};return(i,n)=>(t(),e("div",Y,[o("div",$,[o("div",O,[o("div",j,[o("div",z,[n[3]||(n[3]=o("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Two Factor Authentication",-1)),n[4]||(n[4]=o("p",{class:"text-gray-600 mb-6"},"Add additional security to your account using two factor authentication.",-1)),u.value&&!s.value?(t(),e("h3",G," You have enabled two factor authentication. ")):u.value&&s.value?(t(),e("h3",I," Finish enabling two factor authentication. ")):(t(),e("h3",U," You have not enabled two factor authentication. ")),n[5]||(n[5]=o("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[o("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),u.value?(t(),e("div",J,[m.value?(t(),e("div",X,[o("div",Z,[s.value?(t(),e("p",ee," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),e("p",te," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),o("div",{class:"mt-4 p-2 inline-block bg-white border border-gray-200 rounded-md",innerHTML:m.value},null,8,oe),g.value?(t(),e("div",se,[o("p",ne,[n[1]||(n[1]=E(" Setup Key: ")),o("span",{innerHTML:g.value,class:"font-mono bg-gray-100 px-1 py-0.5 rounded"},null,8,ae)])])):r("",!0),s.value?(t(),e("div",re,[v(D,{for:"code",value:"Code",class:"mb-2"}),v(Q,{id:"code",modelValue:y(c).code,"onUpdate:modelValue":n[0]||(n[0]=p=>y(c).code=p),type:"text",name:"code",class:"block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:L(x,["enter"])},null,8,["modelValue"]),v(N,{message:y(c).errors.code,class:"mt-2"},null,8,["message"])])):r("",!0)])):r("",!0),f.value.length>0&&!s.value?(t(),e("div",ie,[n[2]||(n[2]=o("div",{class:"mt-6 max-w-xl text-sm text-gray-600"},[o("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),o("div",le,[(t(!0),e(q,null,H(f.value,p=>(t(),e("div",{key:p},M(p),1))),128))])])):r("",!0)])):r("",!0),o("div",ce,[u.value?(t(),e("div",ge,[s.value?(t(),e("button",{key:0,type:"button",onClick:x,disabled:a.value,class:h({"opacity-50 cursor-not-allowed":a.value,"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":!a.value})}," Confirm ",10,pe)):r("",!0),f.value.length>0&&!s.value?(t(),e("button",{key:1,type:"button",onClick:R,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Regenerate Recovery Codes ")):r("",!0),f.value.length===0&&!s.value?(t(),e("button",{key:2,type:"button",onClick:b,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Show Recovery Codes ")):r("",!0),s.value?(t(),e("button",{key:3,type:"button",onClick:w,"<!--":"",Or:"",a:"",simple:"",reset:"",if:"",canceling:"",setup:"","--":""},` :disabled="disabling" :class="{ 'opacity-50 cursor-not-allowed': disabling, 'inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-md font-semibold text-xs uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500': !disabling }" > Cancel `)):r("",!0),s.value?r("",!0):(t(),e("button",{key:4,type:"button",onClick:w,disabled:l.value,class:h({"opacity-50 cursor-not-allowed":l.value,"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500":!l.value})},[l.value?(t(),e("span",ve,"Disabling...")):(t(),e("span",ye,"Disable"))],10,be))])):(t(),e("div",ue,[o("button",{type:"button",onClick:T,disabled:a.value,class:h({"opacity-50 cursor-not-allowed":a.value,"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":!a.value})},[a.value?(t(),e("span",fe,"Enabling...")):(t(),e("span",me,"Enable"))],10,de)]))])])])])])]))}},Fe=W(he,[["__scopeId","data-v-30ff24ba"]]);export{Fe as default};

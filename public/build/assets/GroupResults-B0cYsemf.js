import{A as R}from"./AppLayout-AFbEt38E.js";import{e as f,o as n,a as e,d as k,l as C,f as S,c as y,m as A,b as u,u as _,v as F,z as L,F as O,h as V,t as m,n as U,g as z,D as E,w as $,S as M}from"./app-BYM1Msdw.js";import{r as P,a as G,S as q}from"./SummaryCard-BXOy3YTM.js";import{_ as I}from"./QuestionStatsTable-vli-rBD0.js";import{_ as Q}from"./Pagination-BQS00_Gs.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Z}from"./BarChart-DBa3IsG3.js";import{L as H}from"./LineChart-Hh84mRJK.js";import"./ClockIcon-8HWf5iue.js";import"./CheckCircleIcon-BlnO3B2C.js";import"./chart-DUfl3Dpl.js";function J(r,l){return n(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}const K={class:"overflow-x-auto"},W={class:"flex justify-between items-center mb-4"},X={class:"relative max-w-xs"},Y={class:"relative"},ee={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},te={class:"flex space-x-2"},se={class:"min-w-full divide-y divide-gray-200"},ae={class:"bg-white divide-y divide-gray-200"},re={class:"px-6 py-4 whitespace-nowrap"},oe={class:"flex items-center"},ie={class:"flex-shrink-0 h-10 w-10"},le=["src"],ne={class:"ml-4"},de={class:"text-sm font-medium text-gray-900"},ue={class:"text-sm text-gray-500"},ce={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pe={class:"flex items-center"},fe={class:"w-16 bg-gray-200 rounded-full h-2.5 mr-2"},xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},he={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},be={key:1,class:"text-gray-400"},ve=["onClick"],ye={key:0,class:"text-center py-8 text-gray-500"},_e={__name:"AttemptsTable",props:{attempts:{type:Object,required:!0,validator:r=>Array.isArray(r==null?void 0:r.data)&&r.data.every(l=>"id"in l&&"user"in l)},quizId:{type:[Number,String],required:!0}},setup(r){const l=r,x=k(""),g=k("all"),c=k("completed_at"),p=k("desc"),w=C(()=>{var s;if(!((s=l.attempts)!=null&&s.data))return[];let a=[...l.attempts.data];if(x.value){const t=x.value.toLowerCase();a=a.filter(v=>{var D,N,j,B;const h=((N=(D=v.user)==null?void 0:D.name)==null?void 0:N.toLowerCase())||"",b=((B=(j=v.user)==null?void 0:j.email)==null?void 0:B.toLowerCase())||"";return h.includes(t)||b.includes(t)})}return g.value!=="all"&&(a=a.filter(t=>g.value==="passed"?t.is_passed:!t.is_passed)),a.sort((t,v)=>{let h=t[c.value],b=v[c.value];return c.value==="completed_at"&&(h=new Date(h),b=new Date(b)),h<b?p.value==="asc"?-1:1:h>b?p.value==="asc"?1:-1:0}),a}),i=a=>{if(!a)return"N/A";const s=Math.floor(a/60),t=a%60;return`${s}m ${t}s`},o=a=>{if(!a)return"N/A";const s=new Date(a);return s.toLocaleDateString()+" "+s.toLocaleTimeString()},d=a=>{try{window.open(route("examiner.certificates.download",{quiz:a.quiz_id,attempt:a.id}),"_blank")}catch(s){console.error("Failed to generate certificate URL:",s)}};return(a,s)=>(n(),f("div",K,[e("div",W,[e("div",X,[s[4]||(s[4]=e("label",{for:"search",class:"sr-only"},"Search",-1)),e("div",Y,[e("div",ee,[u(_(J),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),A(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>x.value=t),type:"text",name:"search",id:"search",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search attempts..."},null,512),[[F,x.value]])])]),e("div",te,[A(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>g.value=t),class:"block pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},s[5]||(s[5]=[e("option",{value:"all"},"All Statuses",-1),e("option",{value:"passed"},"Passed",-1),e("option",{value:"failed"},"Failed",-1)]),512),[[L,g.value]]),A(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>c.value=t),class:"block pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},s[6]||(s[6]=[e("option",{value:"completed_at"},"Date",-1),e("option",{value:"percentage"},"Score",-1),e("option",{value:"time_spent"},"Duration",-1)]),512),[[L,c.value]]),e("button",{onClick:s[3]||(s[3]=t=>p.value=p.value==="asc"?"desc":"asc"),class:"p-2 rounded-md border border-gray-300 hover:bg-gray-50"},[p.value==="asc"?(n(),y(_(P),{key:0,class:"h-5 w-5 text-gray-400"})):(n(),y(_(G),{key:1,class:"h-5 w-5 text-gray-400"}))])])]),e("table",se,[s[8]||(s[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Score "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Time Spent "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",ae,[(n(!0),f(O,null,V(w.value,t=>(n(),f("tr",{key:t.id},[e("td",re,[e("div",oe,[e("div",ie,[e("img",{class:"h-10 w-10 rounded-full",src:t.user.avatar_url||"/images/default-avatar.png",alt:""},null,8,le)]),e("div",ne,[e("div",de,m(t.user.name),1),e("div",ue,m(t.user.email),1)])])]),e("td",ce,[e("span",{class:U(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",t.is_passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},m(t.is_passed?"Passed":"Failed"),3)]),e("td",me,[e("div",pe,[e("div",fe,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:E(`width: ${t.percentage}%`)},null,4)]),z(" "+m(Math.round(t.percentage))+"% ",1)])]),e("td",xe,m(i(t.time_spent)),1),e("td",ge,m(o(t.completed_at)),1),e("td",he,[t.quiz_id?(n(),y(_(M),{key:0,href:a.route("examiner.quiz.attempts.show",{quiz:t.quiz_id,attempt:t.id}),class:"text-blue-600 hover:text-blue-900 mr-3"},{default:$(()=>s[7]||(s[7]=[z(" Details ")])),_:2,__:[7]},1032,["href"])):(n(),f("span",be,"N/A")),t.is_passed&&t.quiz_id?(n(),f("button",{key:2,onClick:v=>d(t),class:"text-green-600 hover:text-green-900"}," Certificate ",8,ve)):S("",!0)])]))),128))])]),w.value.length===0?(n(),f("div",ye," No attempts match your search criteria ")):S("",!0),r.attempts.last_page>1?(n(),y(Q,{key:1,links:r.attempts.links,class:"mt-4"},null,8,["links"])):S("",!0)]))}},we=T(_e,[["__scopeId","data-v-a5b0cfe0"]]),ke={class:"flex justify-between items-center"},qe={class:"font-semibold text-xl text-gray-800 leading-tight"},$e={class:"py-6"},Se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ae={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Ce={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},ze={class:"bg-white p-6 rounded-lg shadow"},De={class:"bg-white p-6 rounded-lg shadow"},Ne={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},je={class:"p-6 bg-white border-b border-gray-200"},Be={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Le={class:"p-6 bg-white border-b border-gray-200"},Me={__name:"GroupResults",props:{quiz:{type:Object,required:!0},group:{type:Object,required:!0},attempts:{type:Object,required:!0},questionStats:{type:Array,required:!0},averageScore:{type:Number,required:!0},passRate:{type:Number,required:!0}},setup(r){const l=r,x=C(()=>{const i=l.attempts.data.map(d=>Math.floor(d.percentage/10)*10),o=Array(10).fill(0);return i.forEach(d=>{const a=Math.min(Math.floor(d/10),9);o[a]++}),{labels:["0-10%","10-20%","20-30%","30-40%","40-50%","50-60%","60-70%","70-80%","80-90%","90-100%"],datasets:[{label:"Number of Attempts",data:o,backgroundColor:"#3B82F6"}]}}),g=C(()=>{const i=l.attempts.data.reduce((o,d)=>{const a=new Date(d.completed_at).toLocaleDateString();return o[a]=(o[a]||0)+1,o},{});return{labels:Object.keys(i).sort(),datasets:[{label:"Attempts",data:Object.values(i),borderColor:"#10B981",fill:!1}]}}),c={responsive:!0,maintainAspectRatio:!1},p=()=>{const i=["Name","Email","Score","Status","Time Spent","Completed At"],o=l.attempts.data.map(t=>[t.user.name,t.user.email,`${t.percentage}%`,t.is_passed?"Passed":"Failed",w(t.time_spent),new Date(t.completed_at).toLocaleString()]);let d="data:text/csv;charset=utf-8,"+i.join(",")+`
`+o.map(t=>t.join(",")).join(`
`);const a=encodeURI(d),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",`${l.quiz.title}_${l.group.name}_results.csv`),document.body.appendChild(s),s.click(),document.body.removeChild(s)},w=i=>{if(!i)return"N/A";const o=Math.floor(i/60),d=i%60;return`${o}m ${d}s`};return(i,o)=>(n(),y(R,{title:`Group Results - ${r.group.name}`},{header:$(()=>[e("div",ke,[e("h2",qe,m(r.quiz.title)+" - "+m(r.group.name)+" Results ",1),u(_(M),{href:i.route("examiner.quizzes.analysis.index",{quiz:r.quiz.id}),class:"btn btn-sm btn-outline"},{default:$(()=>o[0]||(o[0]=[z(" Back to Full Results ")])),_:1,__:[0]},8,["href"])])]),default:$(()=>[e("div",$e,[e("div",Se,[e("div",Ae,[u(q,{title:"Group Members",value:r.group.members_count,icon:"users"},null,8,["value"]),u(q,{title:"Attempts",value:r.attempts.total,icon:"clipboard-document"},null,8,["value"]),u(q,{title:"Average Score",value:`${Math.round(r.averageScore)}%`,icon:"chart-bar"},null,8,["value"]),u(q,{title:"Pass Rate",value:`${Math.round(r.passRate)}%`,icon:"check-circle"},null,8,["value"])]),e("div",Ce,[e("div",ze,[o[1]||(o[1]=e("h3",{class:"text-lg font-medium mb-4"},"Score Distribution",-1)),u(Z,{data:x.value,options:c},null,8,["data"])]),e("div",De,[o[2]||(o[2]=e("h3",{class:"text-lg font-medium mb-4"},"Completion Over Time",-1)),u(H,{data:g.value,options:c},null,8,["data"])])]),e("div",Ne,[e("div",je,[o[3]||(o[3]=e("h3",{class:"text-lg font-medium mb-4"},"Question Performance",-1)),u(I,{stats:r.questionStats,quiz:r.quiz},null,8,["stats","quiz"])])]),e("div",Be,[e("div",Le,[e("div",{class:"flex justify-between items-center mb-4"},[o[4]||(o[4]=e("h3",{class:"text-lg font-medium"},"Member Attempts",-1)),e("button",{onClick:p,class:"btn btn-sm btn-primary"}," Export to CSV ")]),u(we,{attempts:r.attempts,"quiz-id":r.quiz.id},null,8,["attempts","quiz-id"])])])])])]),_:1},8,["title"]))}},Ze=T(Me,[["__scopeId","data-v-d9243397"]]);export{Ze as default};

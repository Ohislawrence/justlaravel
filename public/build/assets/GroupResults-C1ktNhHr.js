import{A as k}from"./AppLayout-DUw_ZWTf.js";import{f as A,c as f,o as c,w as g,a,b as u,d as w,t as S,j as C,S as D,k as z}from"./app-Do1sSIaC.js";import{S as p}from"./SummaryCard-DIzQqgh9.js";import{A as N,Q as B}from"./AttemptsTable-DzH3XJYQ.js";import{B as j}from"./BarChart-BcLmO9Ex.js";import{L as R}from"./LineChart-DsHrCuZ8.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                  */import"./CheckCircleIcon-DNvCfFLO.js";import"./ClockIcon-0cnmOk7Y.js";import"./Pagination-g71SnpNx.js";import"./chart-DUfl3Dpl.js";const T={class:"flex justify-between items-center"},M={class:"font-semibold text-xl text-gray-800 leading-tight"},$={class:"py-6"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},L={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},V={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},F={class:"bg-white p-6 rounded-lg shadow"},G={key:1,class:"text-gray-500 text-center py-8"},U={class:"bg-white p-6 rounded-lg shadow"},I={key:1,class:"text-gray-500 text-center py-8"},P={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},Q={class:"p-6 bg-white border-b border-gray-200"},J={class:"flex justify-between items-center mb-4"},W=["disabled"],H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"p-6 bg-white border-b border-gray-200"},X={__name:"GroupResults",props:{quiz:{type:Object,required:!0,default:()=>({})},group:{type:Object,required:!0,default:()=>({name:"",members_count:0})},attempts:{type:Object,required:!0,default:()=>({data:[],links:[],meta:{total:0}}),validator:s=>s.data&&Array.isArray(s.data)},questionStats:{type:Array,required:!0,default:()=>[]},averageScore:{type:Number,required:!0,default:0},passRate:{type:Number,required:!0,default:0},totalAttempts:{type:Number,default:0},allAttempts:{type:Array,default:()=>[]}},setup(s){const n=s,h=A(()=>{var r;if(!((r=n.allAttempts)!=null&&r.length))return null;const o=n.allAttempts.map(l=>l.percentage?Math.floor(l.percentage/10)*10:0),t=Array(10).fill(0);return o.forEach(l=>{const e=Math.min(Math.floor(l/10),9);t[e]++}),{labels:["0-10%","10-20%","20-30%","30-40%","40-50%","50-60%","60-70%","70-80%","80-90%","90-100%"],datasets:[{label:"Number of Attempts",data:t,backgroundColor:"#3B82F6"}]}}),b=A(()=>{var l;if(!((l=n.allAttempts)!=null&&l.length))return null;const o=n.allAttempts.reduce((e,d)=>{if(!d.completed_at)return e;const m=new Date(d.completed_at).toISOString().split("T")[0];return e[m]=(e[m]||0)+1,e},{}),t=Object.keys(o).sort((e,d)=>new Date(e)-new Date(d));return{labels:t.map(e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Attempts Completed",data:t.map(e=>o[e]),borderColor:"#10B981",backgroundColor:"#10B98120",borderWidth:2,tension:.1,fill:!0}]}}),v={responsive:!0,maintainAspectRatio:!1},q=()=>{var d;if(!((d=n.attempts.data)!=null&&d.length))return;const o=["Name","Email","Score","Status","Time Spent","Completed At"],t=n.attempts.data.map(i=>{var m,y,x;return[((m=i.user)==null?void 0:m.name)||"Unknown",((y=i.user)==null?void 0:y.email)||"",`${((x=i.percentage)==null?void 0:x.toFixed(1))||0}%`,i.is_passed?"Passed":"Failed",_(i.time_spent),i.completed_at?new Date(i.completed_at).toLocaleString():"N/A"]});let r="data:text/csv;charset=utf-8,"+o.join(",")+`
`+t.map(i=>i.join(",")).join(`
`);const l=encodeURI(r),e=document.createElement("a");e.setAttribute("href",l),e.setAttribute("download",`${n.quiz.title}_${n.group.name}_results.csv`),document.body.appendChild(e),e.click(),document.body.removeChild(e)},_=o=>{if(!o)return"N/A";const t=Math.floor(o/60),r=o%60;return`${t}m ${r}s`};return(o,t)=>(c(),f(k,{title:`Group Results - ${s.group.name}`},{header:g(()=>[a("div",T,[a("h2",M,S(s.quiz.title)+" - "+S(s.group.name)+" Results ",1),u(C(D),{href:o.route("examiner.quizzes.analysis.index",{quiz:s.quiz.id}),class:"btn btn-sm btn-outline"},{default:g(()=>t[0]||(t[0]=[z(" Back to Full Results ")])),_:1,__:[0]},8,["href"])])]),default:g(()=>{var r;return[a("div",$,[a("div",E,[a("div",L,[u(p,{title:"Group Members",value:s.group.members_count||0,icon:"users"},null,8,["value"]),u(p,{title:"Attempts",value:s.totalAttempts||0,icon:"clipboard-document"},null,8,["value"]),u(p,{title:"Average Score",value:`${Math.round(s.averageScore)}%`,icon:"chart-bar"},null,8,["value"]),u(p,{title:"Pass Rate",value:`${Math.round(s.passRate)}%`,icon:"check-circle"},null,8,["value"])]),a("div",V,[a("div",F,[t[1]||(t[1]=a("h3",{class:"text-lg font-medium mb-4"},"Score Distribution",-1)),h.value?(c(),f(j,{key:0,data:h.value,options:v},null,8,["data"])):(c(),w("div",G," No score data available "))]),a("div",U,[t[2]||(t[2]=a("h3",{class:"text-lg font-medium mb-4"},"Completion Over Time",-1)),b.value?(c(),f(R,{data:b.value,options:v,key:JSON.stringify(b.value)},null,8,["data"])):(c(),w("div",I," No completion data available "))])]),a("div",P,[a("div",Q,[a("div",J,[t[3]||(t[3]=a("h3",{class:"text-lg font-medium"},"Member Attempts",-1)),a("button",{onClick:q,class:"btn btn-sm btn-primary",disabled:!((r=s.attempts.data)!=null&&r.length)}," Export to CSV ",8,W)]),u(N,{attempts:s.attempts,"quiz-id":s.quiz.id},null,8,["attempts","quiz-id"])])]),a("div",H,[a("div",K,[t[4]||(t[4]=a("h3",{class:"text-lg font-medium mb-4"},"Question Performance",-1)),u(B,{stats:s.questionStats,quiz:s.quiz},null,8,["stats","quiz"])])])])])]}),_:1},8,["title"]))}},ut=O(X,[["__scopeId","data-v-a080243e"]]);export{ut as default};

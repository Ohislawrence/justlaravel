import{P as V,i as d,x as K,f as P,z as B,d as e,o as t,a as o,h as a,k as E,b as y,a1 as L,j as v,F as q,l as H,t as M,n as h,W as _}from"./app-BL-VfoCG.js";import{_ as N}from"./InputError-DIS5InPL.js";import{_ as D}from"./InputLabel-DeoeMJgW.js";import{_ as Q}from"./TextInput-CwucMHeJ.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"p-6 bg-white border-b border-gray-200"},$={class:"max-w-3xl"},z={key:0,class:"text-lg font-medium text-gray-900"},O={key:1,class:"text-lg font-medium text-gray-900"},j={key:2,class:"text-lg font-medium text-gray-900"},G={key:3},I={key:0},U={class:"mt-4 max-w-xl text-sm text-gray-600"},J={key:0,class:"font-semibold"},X={key:1},Z=["innerHTML"],ee={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},te={class:"font-semibold"},oe=["innerHTML"],se={key:1,class:"mt-4 max-w-md"},ne={key:1},re={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},ae={class:"mt-8 flex flex-wrap items-center gap-3"},ie={key:0},le=["disabled"],ce={key:0},ue={key:1},de={key:1,class:"flex flex-wrap items-center gap-3"},fe=["disabled"],ge=["disabled"],me={key:0},pe={key:1},be={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(k){const C=k,F=V(),r=d(!1),s=d(!1),l=d(!1),g=d(null),m=d(null),f=d([]),c=K({code:""}),u=P(()=>{var i;return!r.value&&((i=F.props.auth.user)==null?void 0:i.two_factor_enabled)});B(u,()=>{u.value||(c.reset(),c.clearErrors())});const T=()=>{confirm("Please confirm your password to enable 2FA.")&&(r.value=!0,_.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([S(),A(),b()]),onFinish:()=>{r.value=!1,s.value=C.requiresConfirmation}}))},S=()=>axios.get(route("two-factor.qr-code")).then(i=>{g.value=i.data.svg}),A=()=>axios.get(route("two-factor.secret-key")).then(i=>{m.value=i.data.secretKey}),b=()=>axios.get(route("two-factor.recovery-codes")).then(i=>{f.value=i.data}),x=()=>{c.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.value=!1,g.value=null,m.value=null}})},R=()=>{confirm("Please confirm your password to regenerate recovery codes.")&&axios.post(route("two-factor.recovery-codes")).then(()=>b())},w=()=>{confirm("Please confirm your password to disable 2FA.")&&(l.value=!0,_.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{l.value=!1,s.value=!1}}))};return(i,n)=>(t(),e("div",Y,[o("div",$,[n[3]||(n[3]=o("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Two Factor Authentication",-1)),n[4]||(n[4]=o("p",{class:"text-gray-600 mb-6"},"Add additional security to your account using two factor authentication.",-1)),u.value&&!s.value?(t(),e("h3",z," You have enabled two factor authentication. ")):u.value&&s.value?(t(),e("h3",O," Finish enabling two factor authentication. ")):(t(),e("h3",j," You have not enabled two factor authentication. ")),n[5]||(n[5]=o("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[o("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),u.value?(t(),e("div",G,[g.value?(t(),e("div",I,[o("div",U,[s.value?(t(),e("p",J," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),e("p",X," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),o("div",{class:"mt-4 p-2 inline-block bg-white border border-gray-200 rounded-md",innerHTML:g.value},null,8,Z),m.value?(t(),e("div",ee,[o("p",te,[n[1]||(n[1]=E(" Setup Key: ")),o("span",{innerHTML:m.value,class:"font-mono bg-gray-100 px-1 py-0.5 rounded"},null,8,oe)])])):a("",!0),s.value?(t(),e("div",se,[y(D,{for:"code",value:"Code",class:"mb-2"}),y(Q,{id:"code",modelValue:v(c).code,"onUpdate:modelValue":n[0]||(n[0]=p=>v(c).code=p),type:"text",name:"code",class:"block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:L(x,["enter"])},null,8,["modelValue"]),y(N,{message:v(c).errors.code,class:"mt-2"},null,8,["message"])])):a("",!0)])):a("",!0),f.value.length>0&&!s.value?(t(),e("div",ne,[n[2]||(n[2]=o("div",{class:"mt-6 max-w-xl text-sm text-gray-600"},[o("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),o("div",re,[(t(!0),e(q,null,H(f.value,p=>(t(),e("div",{key:p},M(p),1))),128))])])):a("",!0)])):a("",!0),o("div",ae,[u.value?(t(),e("div",de,[s.value?(t(),e("button",{key:0,type:"button",onClick:x,disabled:r.value,class:h({"opacity-50 cursor-not-allowed":r.value,"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":!r.value})}," Confirm ",10,fe)):a("",!0),f.value.length>0&&!s.value?(t(),e("button",{key:1,type:"button",onClick:R,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Regenerate Recovery Codes ")):a("",!0),f.value.length===0&&!s.value?(t(),e("button",{key:2,type:"button",onClick:b,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Show Recovery Codes ")):a("",!0),s.value?(t(),e("button",{key:3,type:"button",onClick:w,"<!--":"",Or:"",a:"",simple:"",reset:"",if:"",canceling:"",setup:"","--":""},` :disabled="disabling" :class="{ 'opacity-50 cursor-not-allowed': disabling, 'inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-md font-semibold text-xs uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500': !disabling }" > Cancel `)):a("",!0),s.value?a("",!0):(t(),e("button",{key:4,type:"button",onClick:w,disabled:l.value,class:h({"opacity-50 cursor-not-allowed":l.value,"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500":!l.value})},[l.value?(t(),e("span",me,"Disabling...")):(t(),e("span",pe,"Disable"))],10,ge))])):(t(),e("div",ie,[o("button",{type:"button",onClick:T,disabled:r.value,class:h({"opacity-50 cursor-not-allowed":r.value,"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":!r.value})},[r.value?(t(),e("span",ce,"Enabling...")):(t(),e("span",ue,"Enable"))],10,le)]))])])]))}},_e=W(be,[["__scopeId","data-v-dc04589f"]]);export{_e as default};

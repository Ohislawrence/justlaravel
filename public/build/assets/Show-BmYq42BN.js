import{A as F}from"./AppLayout-D4tiIgvt.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as w,f as h,E as I,d as u,o as d,a as t,t as o,h as $,F as S,l as P,G as V,n as A,c as M,w as E,b as D}from"./app-CNh7BjSf.js";/* empty css                                                                  */const Q={class:"bg-white rounded-lg shadow overflow-hidden"},z={class:"p-6"},L={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},U={class:"bg-blue-50 p-4 rounded-lg"},B={class:"text-2xl font-bold text-blue-900"},J={class:"bg-green-50 p-4 rounded-lg"},R={class:"text-2xl font-bold text-green-900"},G={class:"bg-purple-50 p-4 rounded-lg"},K={class:"text-2xl font-bold text-purple-900"},H={class:"overflow-x-auto"},W={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},st={class:"px-6 py-4 whitespace-nowrap"},ot={class:"flex items-center"},rt={class:"w-full bg-gray-200 rounded-full h-2.5"},nt={class:"ml-2 text-xs font-medium text-gray-700"},at={key:0},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap"},ut={class:"flex items-center"},pt={class:"w-full bg-gray-200 rounded-full h-2.5"},mt={class:"ml-2 text-xs font-medium text-gray-700"},xt={__name:"QuizPoolAnalysis",props:{quiz:{type:Object,required:!0},questionpools:{type:Object,default:()=>({})},attempts:{type:Object,required:!0},userId:{type:Number,required:!0}},setup(n){const g=n,p=w([]),a=w({name:"Others",questionCount:0,correctCount:0,score:0,maxScore:0,percentage:0});w(!0);const m=w({}),b=w([]),v=w([]),q=w(""),l=h(()=>p.value.reduce((c,s)=>c+s.questionCount,0)+a.value.questionCount),i=h(()=>p.value.reduce((c,s)=>c+s.correctCount,0)+a.value.correctCount),y=h(()=>{const c=p.value.reduce((e,r)=>e+r.score,0)+a.value.score,s=p.value.reduce((e,r)=>e+r.maxScore,0)+a.value.maxScore;return s>0?(c/s*100).toFixed(1):0}),_=c=>c>=80?"bg-green-600":c>=60?"bg-yellow-500":"bg-red-600",C=()=>{p.value=[],a.value={name:"Others",questionCount:0,correctCount:0,score:0,maxScore:0,percentage:0},m.value={},b.value=[],v.value=g.attempts.responses||[];const c={},s=Array.isArray(g.questionpools)?g.questionpools:g.questionpools.data||[];s.length>0&&(q.value=JSON.stringify({id:s[0].id,name:s[0].name,hasQuestions:!!s[0].questions,questionsCount:s[0].questions?s[0].questions.length:0,questionsSample:s[0].questions?s[0].questions.slice(0,2):null})),s.forEach(e=>{const r=[];e.questions&&Array.isArray(e.questions)&&e.questions.forEach(x=>{x.id&&r.push(x.id)}),c[e.id]={...e,responses:[],maxScore:0,questionIds:r},m.value[e.id]=r}),v.value.forEach(e=>{const r=e.question;if(!r||!r.id)return;let x=!1;for(const f in c)if(c[f].questionIds.includes(r.id)){c[f].responses.push(e),c[f].maxScore+=r.points||1,x=!0;break}x||(b.value.push(r.id),a.value.maxScore+=r.points||1,c.others||(c.others={id:"others",name:"Others",responses:[],maxScore:0,questionIds:[]}),c.others.responses.push(e),c.others.maxScore+=r.points||1)});for(const e in c){const r=c[e];if(e==="others"){let x=0,f=0;r.responses.forEach(k=>{k.is_correct&&f++,x+=k.points_earned||0}),a.value.questionCount=r.responses.length,a.value.correctCount=f,a.value.score=x,a.value.percentage=a.value.maxScore>0?x/a.value.maxScore*100:0}else{const x=r.responses,f=r.maxScore;let k=0,O=0;x.forEach(T=>{T.is_correct&&O++,k+=T.points_earned||0});const j=f>0?k/f*100:0;p.value.push({id:r.id,name:r.name,questionCount:x.length,correctCount:O,score:k,maxScore:f,percentage:j})}}};return I(()=>{C()}),(c,s)=>(d(),u("div",Q,[s[5]||(s[5]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Quiz Pool Performance Analysis"),t("p",{class:"text-sm text-gray-500 mt-1"},"Performance breakdown by question pool")],-1)),t("div",z,[t("div",L,[t("div",U,[s[0]||(s[0]=t("p",{class:"text-sm font-medium text-blue-800"},"Total Questions",-1)),t("p",B,o(l.value),1)]),t("div",J,[s[1]||(s[1]=t("p",{class:"text-sm font-medium text-green-800"},"Correct Answers",-1)),t("p",R,o(i.value),1)]),t("div",G,[s[2]||(s[2]=t("p",{class:"text-sm font-medium text-purple-800"},"Overall Score",-1)),t("p",K,o(y.value)+"%",1)])]),t("div",H,[t("table",W,[s[4]||(s[4]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Question Pool "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Questions "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Correct "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Score "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Performance ")])],-1)),t("tbody",X,[(d(!0),u(S,null,P(p.value,e=>(d(),u("tr",{key:e.id},[t("td",Y,o(e.name),1),t("td",Z,o(e.questionCount),1),t("td",tt,o(e.correctCount)+" / "+o(e.questionCount),1),t("td",et,o(e.score)+" / "+o(e.maxScore),1),t("td",st,[t("div",ot,[t("div",rt,[t("div",{class:A(["h-2.5 rounded-full",_(e.percentage)]),style:V(`width: ${Math.min(e.percentage,100)}%`)},null,6)]),t("span",nt,o(e.percentage.toFixed(1))+"% ",1)])])]))),128)),a.value.questionCount>0?(d(),u("tr",at,[s[3]||(s[3]=t("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"}," Others ",-1)),t("td",it,o(a.value.questionCount),1),t("td",lt,o(a.value.correctCount)+" / "+o(a.value.questionCount),1),t("td",ct,o(a.value.score)+" / "+o(a.value.maxScore),1),t("td",dt,[t("div",ut,[t("div",pt,[t("div",{class:A(["h-2.5 rounded-full",_(a.value.percentage)]),style:V(`width: ${Math.min(a.value.percentage,100)}%`)},null,6)]),t("span",mt,o(a.value.percentage.toFixed(1))+"% ",1)])])])):$("",!0)])])])])]))}},gt={class:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200"},yt={class:"bg-gray-50 px-4 py-3 border-b border-gray-200"},ft={class:"flex justify-between items-center"},ht={class:"text-lg font-medium text-gray-800"},bt={key:0,class:"text-sm text-gray-600 mt-1"},_t={class:"p-4"},vt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},wt={class:"col-span-2"},$t={class:"bg-gray-50 p-3 rounded-md"},qt={class:"font-medium"},Ct={key:0,class:"text-sm text-gray-600 mt-1"},kt={class:"inline-block px-2 py-1 bg-blue-50 text-blue-800 rounded text-sm"},St={key:2,class:"whitespace-pre-wrap"},At={class:"space-y-3"},Pt={class:"font-medium"},Dt={class:"font-medium"},Ot={key:0},Tt={class:"text-sm"},Vt={key:0,class:"mt-4 pt-4 border-t border-gray-200"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jt={class:"text-sm"},Ft={class:"text-sm"},It={key:0},Mt={class:"text-xs bg-gray-50 p-2 rounded"},Et={__name:"QuestionResponseCard",props:{question:{type:Object,required:!0,default:()=>({question:"",description:"",type:"",points:0,options:[],correct_answers:[]})},response:{type:Object,required:!0,default:()=>({answer:"",is_correct:!1,points_earned:0,time_spent:0,feedback:"",grading_data:null,created_at:""})},questionNumber:{type:Number,required:!0}},setup(n){const g=n,p=w(!1),a=l=>({multiple_choice:"Multiple Choice",true_false:"True/False",short_answer:"Short Answer",essay:"Essay",fill_in_blank:"Fill in Blank",matching:"Matching",ordering:"Ordering"})[l]||l,m=l=>{if(!l)return"N/A";const i=Math.floor(l/60),y=l%60;return`${i}m ${y}s`},b=l=>l?new Date(l).toLocaleString():"N/A",v=l=>l?typeof l=="string"?l:typeof l=="object"?l.text||l.value||JSON.stringify(l):String(l):"No answer provided",q=()=>{var l,i;try{return!((l=g.question)!=null&&l.options)||!((i=g.question)!=null&&i.correct_answers)?"Correct answer not available":g.question.correct_answers.map(y=>{const _=g.question.options[y];return _?v(_):`Option ${y}`}).filter(Boolean).join(", ")}catch(y){return console.error("Error getting correct answers:",y),"Correct answer not available"}};return(l,i)=>(d(),u("div",gt,[t("div",yt,[t("div",ft,[t("h3",ht," Question "+o(n.questionNumber)+": "+o(n.question.question),1),t("span",{class:A(["px-2 py-1 text-xs font-semibold rounded-full",n.response.is_correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},o(n.response.is_correct?"Correct":"Incorrect"),3)]),n.question.description?(d(),u("p",bt,o(n.question.description),1)):$("",!0)]),t("div",_t,[t("div",vt,[t("div",wt,[i[1]||(i[1]=t("h4",{class:"text-sm font-medium text-gray-500 mb-2"},"Student Response",-1)),t("div",$t,[n.question.type==="multiple_choice"?(d(),u(S,{key:0},[t("p",qt,o(v(n.response.answer)),1),n.response.is_correct?$("",!0):(d(),u("p",Ct," Correct answer: "+o(q()),1))],64)):n.question.type==="fill_in_blank"?(d(!0),u(S,{key:1},P(Array.isArray(n.response.answer)?n.response.answer:[n.response.answer],(y,_)=>(d(),u("div",{key:_,class:"mb-1"},[t("span",kt,o(y),1)]))),128)):(d(),u("p",St,o(n.response.answer),1))])]),t("div",null,[i[5]||(i[5]=t("h4",{class:"text-sm font-medium text-gray-500 mb-2"},"Performance",-1)),t("div",At,[t("div",null,[i[2]||(i[2]=t("p",{class:"text-xs text-gray-500"},"Points Earned",-1)),t("p",Pt,o(n.response.points_earned)+" / "+o(n.question.points),1)]),t("div",null,[i[3]||(i[3]=t("p",{class:"text-xs text-gray-500"},"Time Spent",-1)),t("p",Dt,o(m(n.response.time_spent)),1)]),n.response.feedback?(d(),u("div",Ot,[i[4]||(i[4]=t("p",{class:"text-xs text-gray-500"},"Feedback",-1)),t("p",Tt,o(n.response.feedback),1)])):$("",!0)])])]),p.value?(d(),u("div",Vt,[i[9]||(i[9]=t("h4",{class:"text-sm font-medium text-gray-500 mb-2"},"Details",-1)),t("div",Nt,[t("div",null,[i[6]||(i[6]=t("p",{class:"text-xs text-gray-500"},"Question Type",-1)),t("p",jt,o(a(n.question.type)),1)]),t("div",null,[i[7]||(i[7]=t("p",{class:"text-xs text-gray-500"},"Answered At",-1)),t("p",Ft,o(b(n.response.created_at)),1)]),n.response.grading_data?(d(),u("div",It,[i[8]||(i[8]=t("p",{class:"text-xs text-gray-500"},"Grading Data",-1)),t("pre",Mt,o(JSON.stringify(n.response.grading_data,null,2)),1)])):$("",!0)])])):$("",!0),t("button",{onClick:i[0]||(i[0]=y=>p.value=!p.value),class:"mt-3 text-sm text-blue-600 hover:text-blue-800 focus:outline-none"},o(p.value?"Hide Details":"Show Details"),1)])]))}},Qt=N(Et,[["__scopeId","data-v-0c5f2b51"]]),zt={class:"bg-white rounded-lg shadow overflow-hidden"},Lt={class:"p-6"},Ut={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Bt={class:"bg-red-50 p-4 rounded-lg"},Jt={class:"text-2xl font-bold text-red-900"},Rt={class:"bg-yellow-50 p-4 rounded-lg"},Gt={class:"text-2xl font-bold text-yellow-900"},Kt={class:"bg-blue-50 p-4 rounded-lg"},Ht={class:"text-2xl font-bold text-blue-900"},Wt={key:0,class:"mb-6"},Xt={class:"space-y-3"},Yt={class:"flex-shrink-0"},Zt={class:"text-xs font-medium text-white"},te={class:"ml-3"},ee={class:"text-sm font-medium text-gray-900"},se={class:"text-sm text-gray-500"},oe={class:"text-xs text-gray-400 mt-1"},re={key:1,class:"mb-6"},ne={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ae={class:"flex items-center justify-between"},ie={class:"text-sm font-medium text-gray-900"},le={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ce={key:2,class:"text-center py-8 text-gray-500"},de={__name:"ProctoringTable",props:{attempts:{type:[Array,Object],required:!0,default:()=>[]}},setup(n){const g=n,p=h(()=>Array.isArray(g.attempts)?g.attempts:g.attempts&&Array.isArray(g.attempts.data)?g.attempts.data:[]);h(()=>p.value.filter(s=>s.proctoring_data).length),h(()=>{const s=p.value.find(e=>e.proctoring_data);return s?s.proctoring_data.substring(0,100)+"...":"None"});const a=h(()=>{const s=[];return p.value.forEach(e=>{if(e.proctoring_data)try{const r=JSON.parse(e.proctoring_data);Array.isArray(r)&&r.forEach(x=>{var f;s.push({...x,attempt_id:e.id,user_id:e.user_id,user_name:((f=e.user)==null?void 0:f.name)||"Unknown User",attempt_number:e.attempt_number,score:e.score,percentage:e.percentage})})}catch(r){console.error("Failed to parse proctoring_data:",r,e.proctoring_data)}}),s}),m=h(()=>a.value),b=h(()=>{const s={};return m.value.forEach(e=>{s[e.type]||(s[e.type]=0),s[e.type]++}),Object.entries(s).map(([e,r])=>({type:e,count:r})).sort((e,r)=>r.count-e.count)}),v=h(()=>m.value.length),q=h(()=>m.value.filter(s=>s.type==="tab_switch").length),l=h(()=>m.value.filter(s=>s.type!=="tab_switch").length),i=h(()=>[...m.value].sort((s,e)=>new Date(e.timestamp)-new Date(s.timestamp))),y=s=>({tab_switch:"Tab Switch",face_not_visible:"Face Not Visible",multiple_faces:"Multiple Faces Detected",voice_detected:"Voice Detected",mobile_phone:"Mobile Phone Detected",person_left:"Person Left Camera View",paste_attempt:"Paste Attempt",copy_attempt:"Copy Attempt",forbidden_key_combination:"Forbidden Key Combination"})[s]||s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),_=s=>({tab_switch:"bg-red-500",face_not_visible:"bg-yellow-500",multiple_faces:"bg-orange-500",voice_detected:"bg-purple-500",mobile_phone:"bg-blue-500",person_left:"bg-indigo-500",paste_attempt:"bg-pink-500",copy_attempt:"bg-teal-500",forbidden_key_combination:"bg-cyan-500"})[s]||"bg-gray-500",C=s=>({tab_switch:"TS",face_not_visible:"FNV",multiple_faces:"MF",voice_detected:"VD",mobile_phone:"MP",person_left:"PL",paste_attempt:"PA",copy_attempt:"CA",forbidden_key_combination:"FK"})[s]||s.substring(0,2).toUpperCase(),c=s=>{if(!s)return"Unknown time";try{return new Date(s).toLocaleString()}catch{return s}};return w(!0),(s,e)=>(d(),u("div",zt,[e[5]||(e[5]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Proctoring Violations"),t("p",{class:"text-sm text-gray-500 mt-1"},"Monitoring of exam integrity violations")],-1)),t("div",Lt,[t("div",Ut,[t("div",Bt,[e[0]||(e[0]=t("p",{class:"text-sm font-medium text-red-800"},"Total Violations",-1)),t("p",Jt,o(v.value),1)]),t("div",Rt,[e[1]||(e[1]=t("p",{class:"text-sm font-medium text-yellow-800"},"Tab Switch Violations",-1)),t("p",Gt,o(q.value),1)]),t("div",Kt,[e[2]||(e[2]=t("p",{class:"text-sm font-medium text-blue-800"},"Other Violations",-1)),t("p",Ht,o(l.value),1)])]),m.value.length>0?(d(),u("div",Wt,[e[3]||(e[3]=t("h4",{class:"text-md font-medium mb-3"},"Violation Timeline",-1)),t("div",Xt,[(d(!0),u(S,null,P(i.value,(r,x)=>(d(),u("div",{key:x,class:"flex items-start p-3 border border-gray-200 rounded-lg"},[t("div",Yt,[t("span",{class:A(["inline-flex items-center justify-center h-8 w-8 rounded-full",_(r.type)])},[t("span",Zt,o(C(r.type)),1)],2)]),t("div",te,[t("p",ee,o(y(r.type)),1),t("p",se,o(c(r.timestamp)),1),t("p",oe," Attempt #"+o(r.attempt_number)+" by "+o(r.user_name),1)])]))),128))])])):$("",!0),b.value.length>0?(d(),u("div",re,[e[4]||(e[4]=t("h4",{class:"text-md font-medium mb-3"},"Violation Types",-1)),t("div",ne,[(d(!0),u(S,null,P(b.value,(r,x)=>(d(),u("div",{key:x,class:"p-3 border border-gray-200 rounded-lg"},[t("div",ae,[t("span",ie,o(y(r.type)),1),t("span",le,o(r.count),1)])]))),128))])])):$("",!0),m.value.length===0?(d(),u("div",ce," No proctoring violations detected ")):$("",!0)])]))}},ue={class:"py-6"},pe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},me={class:"flex justify-between items-start"},xe={class:"text-gray-600 mt-2"},ge={class:"text-gray-600"},ye={class:"text-right"},fe={class:"text-sm text-gray-500 mt-1"},he={class:"mb-6"},be={class:"mb-6"},_e={class:"space-y-6"},ve={__name:"Show",props:{quiz:{type:Object,default:()=>({})},attempt:{type:Object,default:()=>({})},questions:{type:Array,default:()=>[]},questionpools:Object,violations:Array},setup(n){const g=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleString()}catch{return"Invalid Date"}},p=a=>{if(!a)return"N/A";const m=Math.floor(a/60),b=a%60;return`${m}m ${b}s`};return(a,m)=>{var b;return d(),M(F,{title:`Attempt #${((b=n.attempt)==null?void 0:b.attempt_number)||"Unknown"}`},{default:E(()=>{var v,q,l,i,y,_,C,c,s;return[t("div",ue,[t("div",pe,[t("div",{class:A(["bg-white shadow-sm sm:rounded-lg mb-6 p-6 border-l-4",(v=n.attempt)!=null&&v.is_passed?"border-green-500":"border-red-500"])},[t("div",me,[t("div",null,[m[0]||(m[0]=t("h2",{class:"text-xl font-semibold"},"Attempt Details",-1)),t("p",xe," Examinee: "+o(((l=(q=n.attempt)==null?void 0:q.user)==null?void 0:l.name)||"Unknown User")+" ("+o(((y=(i=n.attempt)==null?void 0:i.user)==null?void 0:y.email)||"No email")+") ",1),t("p",ge," Completed: "+o(g((_=n.attempt)==null?void 0:_.completed_at)),1)]),t("div",ye,[t("span",{class:A(["px-3 py-1 rounded-full text-sm font-medium",(C=n.attempt)!=null&&C.is_passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])}," Score: "+o(((c=n.attempt)==null?void 0:c.percentage)||0)+"% ",3),t("p",fe," Time: "+o(p((s=n.attempt)==null?void 0:s.time_spent)),1)])])],2),t("div",he,[D(xt,{quiz:n.quiz,questionpools:n.questionpools,attempts:n.attempt,userId:n.attempt.user.id},null,8,["quiz","questionpools","attempts","userId"])]),t("div",be,[D(de,{attempts:n.violations},null,8,["attempts"])]),t("div",_e,[(d(!0),u(S,null,P(n.questions,e=>{var r;return d(),u("div",{key:e.id,class:"bg-white shadow-sm sm:rounded-lg p-6 hover:shadow-md transition-shadow duration-200 border border-gray-100"},[D(Qt,{question:e,response:(r=e.responses)==null?void 0:r[0]},null,8,["question","response"])])}),128))])])])]}),_:1},8,["title"])}}},ke=N(ve,[["__scopeId","data-v-27eac1a2"]]);export{ke as default};
